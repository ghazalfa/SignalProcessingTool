use std::cmp::max;

// use src::mods::digital_filters::fir;
// use crate::src::mods::datatype::RawData;
use biquad::*;
use criterion::{black_box, criterion_group, criterion_main, Criterion};
use ndarray::Data;
use plotters::data::{self, float};
use SpectralEngine::mods::data_resampling::DataResampling;
use SpectralEngine::mods::datatype::RawData;
use SpectralEngine::mods::digital_filters::fir::{highpass, notch};
use SpectralEngine::mods::digital_filters::iir::{self, moving_average};
use SpectralEngine::mods::fast_fourier_transform::Fft;
use SpectralEngine::mods::math::Math;
use SpectralEngine::mods::peak_finder::PeakFinder;
use SpectralEngine::mods::windowing::Windowing;

fn criterion_benchmark(c: &mut Criterion) {
    let signal: Vec<f32> = vec![
        0.0343756377696991,
        0.032461017370224,
        0.0305894017219543,
        0.0305086821317672,
        0.0295474678277969,
        0.0298603773117065,
        0.0304441452026367,
        0.0314627736806869,
        0.0320333689451217,
        0.0321695357561111,
        0.0321424901485443,
        0.03257717192173,
        0.032631292939186,
        0.0330526232719421,
        0.0336777865886688,
        0.0350241512060165,
        0.0360039919614791,
        0.0370121002197265,
        0.0393852442502975,
        0.0416955202817916,
        0.0439279228448867,
        0.0456417948007583,
        0.0468773394823074,
        0.0483060628175735,
        0.049144223332405,
        0.0496799498796463,
        0.0500779300928115,
        0.0505856424570083,
        0.0499932020902633,
        0.0496473759412765,
        0.0488329082727432,
        0.0488476008176803,
        0.0485868006944656,
        0.0481465607881546,
        0.0479535907506942,
        0.0477346926927566,
        0.0483406633138656,
        0.0482446998357772,
        0.0487267524003982,
        0.0487685054540634,
        0.0488791614770889,
        0.0490847378969192,
        0.0493467897176742,
        0.0498971194028854,
        0.049829289317131,
        0.0499253720045089,
        0.0501593798398971,
        0.049499288201332,
        0.0501039773225784,
        0.0497592538595199,
        0.0495942682027816,
        0.0494971126317977,
        0.0493039041757583,
        0.0488634258508682,
        0.0485179275274276,
        0.0482154041528701,
        0.0470748394727706,
        0.0467174500226974,
        0.0465247184038162,
        0.0463737100362777,
        0.0459623783826828,
        0.0454960316419601,
        0.0446595102548599,
        0.0448113530874252,
        0.0448519438505172,
        0.045334592461586,
        0.0453210324048996,
        0.0461454838514328,
        0.0465995520353317,
        0.0470809191465377,
        0.0472873002290725,
        0.0474665611982345,
        0.047109916806221,
        0.0470809191465377,
        0.0467651337385177,
        0.0467922836542129,
        0.0467632263898849,
        0.0457476824522018,
        0.0459799617528915,
        0.0456780344247818,
        0.0444863587617874,
        0.0436503589153289,
        0.0424045771360397,
        0.0403403937816619,
        0.0391666889190673,
        0.0385672152042388,
        0.0386646836996078,
        0.038624420762062,
        0.0395953655242919,
        0.0392135977745056,
        0.0400202125310897,
        0.0395967364311218,
        0.0396242439746856,
        0.0399378985166549,
        0.0402386337518692,
        0.0400610417127609,
        0.0413181483745574,
        0.041359394788742,
        0.0425902605056762,
        0.0439320355653762,
        0.0458803325891494,
        0.0476940423250198,
        0.049027219414711,
        0.0501436442136764,
        0.0513412207365036,
        0.0521543771028518,
        0.0528297871351242,
        0.0527460724115371,
        0.0532697588205337,
        0.0533933788537979,
        0.0536008328199386,
        0.0536281019449234,
        0.0536123067140579,
        0.0530896037817001,
        0.0524665564298629,
        0.0521494299173355,
        0.0506453961133956,
        0.0516670495271682,
        0.0517350584268569,
        0.0510603934526443,
        0.051128402352333,
        0.0511419922113418,
        0.0507007986307144,
        0.0512936264276504,
        0.0509893149137496,
        0.0512664467096328,
        0.0510865598917007,
        0.0513344258069992,
        0.0514452904462814,
        0.0518856793642044,
        0.0514996498823165,
        0.0512507408857345,
        0.0510154217481613,
        0.0511115938425064,
        0.0508774071931839,
        0.0509453266859054,
        0.0505460351705551,
        0.0504352301359176,
        0.0500225573778152,
        0.0499660819768905,
        0.0497874766588211,
        0.0496349483728408,
        0.0492225438356399,
        0.0486725121736526,
        0.0480538755655288,
        0.0485879033803939,
        0.0477774888277053,
        0.0469800680875778,
        0.0467060059309005,
        0.0459092706441879,
        0.0455938428640365,
        0.0448384135961532,
        0.0436467677354812,
        0.0426734536886215,
        0.0425084233283996,
        0.0418802499771118,
        0.0418378710746765,
        0.0413865447044372,
        0.0412100106477737,
        0.0412496328353881,
        0.0418919026851654,
        0.0415774881839752,
        0.0416189432144165,
        0.0418378710746765,
        0.042001873254776,
        0.0422343760728836,
        0.0429591834545135,
        0.0425499230623245,
        0.0431406497955322,
        0.0425941050052642,
        0.0418278872966766,
        0.0398324877023696,
        0.0374854505062103,
        0.0354832857847213,
        0.0342724472284317,
        0.0337032079696655,
        0.0335410088300704,
        0.0341675132513046,
        0.0344403833150863,
        0.0349852591753006,
        0.0352440774440765,
        0.0358571708202362,
        0.0363885313272476,
        0.0369750410318374,
        0.0375340580940246,
        0.0392812192440032,
        0.0398000329732894,
        0.0411395579576492,
        0.0417948961257934,
        0.0444525033235549,
        0.0465526431798934,
        0.0485722869634628,
        0.049590453505516,
        0.0507337599992752,
        0.0514210909605026,
        0.0519316345453262,
        0.0523713082075119,
        0.0533493012189865,
        0.0536259263753891,
        0.0537358969449996,
        0.0541634410619735,
        0.0544538348913192,
        0.0537347644567489,
        0.0539683252573013,
        0.0531679838895797,
        0.0526433736085891,
        0.0527260452508926,
        0.0519944280385971,
        0.0521461516618728,
        0.051234945654869,
        0.0514148622751235,
        0.0511523634195327,
        0.0508898943662643,
        0.0510686188936233,
        0.0511251837015152,
        0.0510550588369369,
        0.0512620955705642,
        0.0498417466878891,
        0.0511795133352279,
        0.0507643371820449,
        0.0505449324846267,
        0.0506139248609542,
        0.0503651350736618,
        0.0501175373792648,
        0.0499649494886398,
        0.0498406141996383,
        0.0494699627161026,
        0.0492078810930252,
        0.0489865094423294,
        0.048436626791954,
        0.0480235368013381,
        0.0473229140043258,
        0.0464987307786941,
        0.0461133569478988,
        0.0453305691480636,
        0.0451796799898147,
        0.0443985015153884,
        0.0439597815275192,
        0.0438641458749771,
        0.0436718761920928,
        0.0431783497333526,
        0.0437674969434738,
        0.0435887724161148,
        0.0440003424882888,
        0.0441635400056839,
        0.0443018227815628,
        0.0436001867055892,
        0.0443964451551437,
        0.0449174791574478,
        0.0450131744146347,
        0.0451110154390335,
        0.044590875506401,
        0.0432614088058471,
        0.0405806601047515,
        0.0375507622957229,
        0.0359973460435867,
        0.0344472080469131,
        0.0336050540208816,
        0.0333212167024612,
        0.0335266441106796,
        0.0339355915784835,
        0.034643143415451,
        0.0346980690956115,
        0.0349293798208236,
        0.0356510728597641,
        0.0364549160003662,
        0.0378865152597427,
        0.0384593158960342,
        0.0397016406059265,
        0.0407941192388534,
        0.0418324768543243,
        0.0435435324907302,
        0.0454628616571426,
        0.0472339242696762,
        0.0484146922826767,
        0.0492267161607742,
        0.0503266304731369,
        0.0510550588369369,
        0.0512768179178237,
        0.0518799871206283,
        0.0519761890172958,
        0.0515630692243576,
        0.0512721687555313,
        0.050996109843254,
        0.0499355345964431,
        0.0494259148836135,
        0.0486816018819808,
        0.0482142716646194,
        0.0477188974618911,
        0.0471289902925491,
        0.0467163473367691,
        0.0467163473367691,
        0.0463049560785293,
        0.0468403548002243,
        0.0469361990690231,
        0.047652319073677,
        0.0477200299501419,
        0.0481454282999038,
        0.0483937412500381,
        0.0485032349824905,
        0.0491908937692642,
        0.0491478890180587,
        0.0487222224473953,
        0.0482119172811508,
        0.049477681517601,
        0.0486668795347213,
        0.0491601973772048,
        0.0491183847188949,
        0.0485279411077499,
        0.0482648164033889,
        0.0476883202791214,
        0.0466306656599044,
        0.0467129498720169,
        0.0459286123514175,
        0.0446811765432357,
        0.0438307672739028,
        0.043530523777008,
        0.0426808893680572,
        0.0425168573856353,
        0.0413816571235656,
        0.040890097618103,
        0.0405749678611755,
        0.0404796153306961,
        0.0406164228916168,
        0.0409035831689834,
        0.0411773324012756,
        0.0415465682744979,
        0.0416555106639862,
        0.0423258692026138,
        0.0425314158201217,
        0.0429166555404663,
        0.0428365916013717,
        0.0416054278612136,
        0.0398030877113342,
        0.0380959957838058,
        0.0364758968353271,
        0.0352378338575363,
        0.0351298302412033,
        0.0346413403749465,
        0.0351874083280563,
        0.0361542999744415,
        0.0368915498256683,
        0.0368101745843887,
        0.0374783426523208,
        0.0368783622980117,
        0.0372876226902008,
        0.0372452735900878,
        0.03843355178833,
        0.0393750071525573,
        0.0405629277229309,
        0.0417937338352203,
        0.0433949828147888,
        0.0458215624094009,
        0.0478413552045822,
        0.0493538230657577,
        0.0510886162519454,
        0.0518323332071304,
        0.0529220253229141,
        0.0538594871759414,
        0.0547023266553878,
        0.0551709681749343,
        0.055404707789421,
        0.0555147677659988,
        0.0549892038106918,
        0.0544490069150924,
        0.0536064654588699,
        0.0526805967092514,
        0.0519490391016006,
        0.0514373630285263,
        0.050431802868843,
        0.0507767349481582,
        0.0505833476781845,
        0.0501571148633956,
        0.0504736751317977,
        0.0502260774374008,
        0.0501164346933364,
        0.0503911226987838,
        0.0504046827554702,
        0.0505290776491165,
        0.0507213026285171,
        0.0507077425718307,
        0.0507902950048446,
        0.0506929904222488,
        0.0507755428552627,
        0.0505414754152298,
        0.0504724830389022,
        0.0502926856279373,
        0.0499490946531295,
        0.0493705421686172,
        0.0491208285093307,
        0.0490666478872299,
        0.0484626144170761,
        0.0479942113161087,
        0.0474864989519119,
        0.0463049560785293,
        0.0460164994001388,
        0.044987216591835,
        0.0445617884397506,
        0.0442051440477371,
        0.0431783497333526,
        0.0428085923194885,
        0.0427255630493164,
        0.0417694002389907,
        0.042001873254776,
        0.0422199070453643,
        0.0419478267431259,
        0.0425624698400497,
        0.0425074696540832,
        0.0424399077892303,
        0.042644515633583,
        0.0428501069545745,
        0.0435356944799423,
        0.04331836104393,
        0.0428267568349838,
        0.0410486161708831,
        0.0392323434352874,
        0.037826657295227,
        0.0363150835037231,
        0.0359348505735397,
        0.0355951786041259,
        0.0362228900194168,
        0.0364014506340026,
        0.0372333377599716,
        0.0373701155185699,
        0.0373158007860183,
        0.0377795398235321,
        0.0383117198944091,
        0.0388305187225341,
        0.0398004353046417,
        0.0406474471092224,
        0.0411808043718338,
        0.0426990389823913,
        0.0438349694013595,
        0.0466070920228958,
        0.0484762042760849,
        0.0501138716936111,
        0.0512440651655197,
        0.0524560362100601,
        0.0536427646875381,
        0.0539330691099166,
        0.0549531430006027,
        0.0552846044301986,
        0.0548158138990402,
        0.0553527027368545,
        0.0546058863401412,
        0.0544538348913192,
        0.0538855344057083,
        0.0531679838895797,
        0.0524904280900955,
        0.0520216077566146,
        0.0516774207353591,
        0.0511953085660934,
        0.0509203225374221,
        0.0513458400964736,
        0.0504781454801559,
        0.0508491545915603,
        0.0507383197546005,
        0.0506150275468826,
        0.0507654696702957,
        0.0509170442819595,
        0.050243005156517,
        0.0507937520742416,
        0.0505992323160171,
        0.0506127923727035,
        0.0499796420335769,
        0.0501028448343277,
        0.0495524555444717,
        0.0493728369474411,
        0.0493310242891311,
        0.0483135730028152,
        0.048684999346733,
        0.0481612235307693,
        0.0476116687059402,
        0.0468560606241226,
        0.0461966842412948,
        0.0454689711332321,
        0.0450028032064437,
        0.0444265753030777,
        0.0442487448453903,
        0.0436863750219345,
        0.0435221791267395,
        0.0430702269077301,
        0.0428510755300521,
        0.0428781062364578,
        0.0427825301885604,
        0.0433019697666168,
        0.0429466515779495,
        0.0430142283439636,
        0.0430422276258468,
        0.0430142283439636,
        0.0434796512126922,
        0.0436728596687316,
        0.0439201742410659,
        0.0438264161348342,
        0.0419919192790985,
        0.0402014106512069,
        0.038249060511589,
        0.0360694825649261,
        0.0352395623922348,
        0.0354173779487609,
        0.0349560528993606,
        0.0355148315429687,
        0.0359379202127456,
        0.0362654626369476,
        0.0364563912153244,
        0.0373154729604721,
        0.0372201055288314,
        0.0379156917333602,
        0.0386112630367279,
        0.0393075793981552,
        0.0405645072460174,
        0.0418492257595062,
        0.0434234887361526,
        0.0452606827020645,
        0.0475541204214096,
        0.0488741844892501,
        0.0502364188432693,
        0.051240250468254,
        0.0524958819150924,
        0.0523566454648971,
        0.0532937794923782,
        0.0529334098100662,
        0.053223505616188,
        0.0535544902086257,
        0.0534297972917556,
        0.0525742620229721,
        0.0528347939252853,
        0.0517861098051071,
        0.051662728190422,
        0.0510686188936233,
        0.0508627444505691,
        0.049937829375267,
        0.0502419024705886,
        0.0497332066297531,
        0.0496767610311508,
        0.0498564392328262,
        0.0498982220888137,
        0.0499253720045089,
        0.0498146265745162,
        0.0495671182870864,
        0.049883559346199,
        0.0496349483728408,
        0.0498688966035842,
        0.0493457168340683,
        0.0490418523550033,
        0.0482424944639205,
        0.0479140728712081,
        0.0480788201093673,
        0.0477482229471206,
        0.0474188178777694,
        0.0465674549341201,
        0.0470060557126998,
        0.0460040420293808,
        0.0455376654863357,
        0.0446168929338455,
        0.0442622750997543,
        0.0437829941511154,
        0.0434255897998809,
        0.0431658178567886,
        0.0419459342956543,
        0.0425354540348053,
        0.0426589846611022,
        0.042385846376419,
        0.042481392621994,
        0.0425489693880081,
        0.0430972576141357,
        0.0427130460739135,
        0.0429997146129608,
        0.0432198792695999,
        0.043041244149208,
        0.043206363916397,
        0.0438921600580215,
        0.0435249805450439,
        0.0415404736995697,
        0.0398324877023696,
        0.0375671833753585,
        0.0359865874052047,
        0.0342729836702346,
        0.0341654270887374,
        0.0341658890247345,
        0.0340994745492935,
        0.0343313664197921,
        0.0350940376520156,
        0.0349445790052413,
        0.0356527715921402,
        0.0361294597387313,
        0.0367155373096466,
        0.0371379703283309,
        0.0384339541196823,
        0.0390482693910598,
        0.0406459867954254,
        0.0421910881996154,
        0.0439857691526412,
        0.0464552491903305,
        0.0477741807699203,
        0.0490391701459884,
        0.0505395084619522,
        0.0512966364622116,
        0.0517507046461105,
        0.0519976764917373,
        0.0520238131284713,
        0.0523273199796676,
        0.0518856793642044,
        0.0527815669775009,
        0.0521053820848465,
        0.0520363003015518,
        0.0507948249578475,
        0.0508909970521926,
        0.0505460351705551,
        0.0501197427511215,
        0.0497614294290542,
        0.0496653467416763,
        0.0492653995752334,
        0.0495264083147048,
        0.0493750125169754,
        0.0494303554296493,
        0.0495806783437728,
        0.0494032055139541,
        0.0495264083147048,
        0.0495264083147048,
        0.0496778339147567,
        0.0497332066297531,
        0.0496767610311508,
        0.0497739166021347,
        0.0493874996900558,
        0.0491943210363388,
        0.048754945397377,
        0.0482165068387985,
        0.0483959764242172,
        0.0473646372556686,
        0.0469946414232254,
        0.0461425334215164,
        0.0457312315702438,
        0.0449621826410293,
        0.044633463025093,
        0.0443589240312576,
        0.0439752489328384,
        0.043180301785469,
        0.0431532561779022,
        0.0424688160419464,
        0.0427699536085128,
        0.0429060906171798,
        0.0428375601768493,
        0.0424678772687912,
        0.0423173457384109,
        0.0420577824115753,
        0.0420433431863784,
        0.0423299074172973,
        0.0425093621015548,
        0.0426473319530487,
        0.0431550741195678,
        0.0421297401189804,
        0.0403389483690261,
        0.0389868021011352,
        0.0363961607217788,
        0.035443902015686,
        0.0343560576438903,
        0.0345611274242401,
        0.0345754623413085,
        0.0349710881710052,
        0.0349174439907074,
        0.0357073247432708,
        0.035830020904541,
        0.0366340726613998,
        0.0365387350320816,
        0.0377520322799682,
        0.0384750813245773,
        0.039362758398056,
        0.0403461903333663,
        0.0416171997785568,
        0.0429861992597579,
        0.0456456393003463,
        0.0468398183584213,
        0.0484073311090469,
        0.0495895892381668,
        0.0506085008382797,
        0.0509933680295944,
        0.0518323332071304,
        0.0520803481340408,
        0.0518856793642044,
        0.0526297539472579,
        0.0526286214590072,
        0.0521744638681411,
        0.052241250872612,
        0.0516899079084396,
        0.0509170442819595,
        0.050489529967308,
        0.0499660819768905,
        0.0500214546918869,
        0.0500610321760177,
        0.0501311272382736,
        0.0500621646642684,
        0.0501164346933364,
        0.0502961724996566,
        0.050364002585411,
        0.0508333295583725,
        0.0512869507074356,
        0.0510120540857315,
        0.0513152629137039,
        0.0514928251504898,
        0.0517690032720565,
        0.0511070042848587,
        0.0515063852071762,
        0.0510380119085311,
        0.0511341542005538,
        0.0508026629686355,
        0.0502508133649826,
        0.0497287064790725,
        0.0498100072145462,
        0.0489435940980911,
        0.0483519583940506,
        0.0477730482816696,
        0.0466881841421127,
        0.0458779782056808,
        0.0451640337705612,
        0.0447655767202377,
        0.0444099456071853,
        0.0446012765169143,
        0.04427270591259,
        0.0442997068166732,
        0.0440803617238998,
        0.0441489666700363,
        0.0437103360891342,
        0.0437508672475814,
        0.0429010689258575,
        0.0424493998289108,
        0.0422168970108032,
        0.0420663952827453,
        0.0412882417440414,
        0.0396350026130676,
        0.038245216012001,
        0.0356027483940124,
        0.0336583703756332,
        0.0327897816896438,
        0.0317863076925277,
        0.0314886271953582,
        0.0318698287010192,
        0.0332291722297668,
        0.0340462327003479,
        0.0340733379125595,
        0.0338695049285888,
        0.0333658009767532,
        0.034276857972145,
        0.0350523889064788,
        0.0367691069841384,
        0.0379416644573211,
        0.0388972014188766,
        0.0401531010866165,
        0.0422589778900146,
        0.0441216379404068,
        0.0463585406541824,
        0.047854945063591,
        0.0496022850275039,
        0.0508689731359481,
        0.0518605858087539,
        0.0527690798044204,
        0.0532246381044387,
        0.0529741793870925,
        0.0537755638360977,
        0.0536372512578964,
        0.0535261183977127,
        0.0533730536699295,
        0.0516899079084396,
        0.0505324751138687,
        0.0502961724996566,
        0.0494292825460433,
        0.0488791614770889,
        0.0488091856241226,
        0.0477368384599685,
        0.0474480241537094,
        0.047530397772789,
        0.0476127415895462,
        0.0479015856981277,
        0.0485754460096359,
        0.0483970493078231,
        0.0487695783376693,
        0.0489480346441268,
        0.0491683036088943,
        0.0490022748708725,
        0.0491400808095932,
        0.0491954237222671,
        0.0492632240056991,
        0.0482582598924636,
        0.0482165068387985,
        0.0480381697416305,
        0.0479975193738937,
        0.0482457727193832,
        0.0485212057828903,
        0.0485212057828903,
        0.0481362491846084,
        0.0471884459257125,
        0.0465007871389389,
        0.0454023033380508,
        0.0446489006280899,
        0.0443048030138015,
        0.0437704175710678,
        0.0427996963262558,
        0.0421559661626815,
        0.0422379970550537,
        0.0410350859165191,
        0.0412539392709732,
        0.0407749116420745,
        0.0409125387668609,
        0.041363775730133,
        0.0422261357307434,
        0.0427336394786834,
        0.0437477082014083,
        0.0442694276571273,
        0.0442709773778915,
        0.0426409542560577,
        0.0407392680644989,
        0.0387450158596038,
        0.0372578650712966,
        0.036481574177742,
        0.0356785655021667,
        0.0357470661401748,
        0.0363336205482482,
        0.037070408463478,
        0.0371389091014862,
        0.0370160788297653,
        0.0374797135591506,
        0.0374256372451782,
        0.0375207811594009,
        0.0381211340427398,
        0.0372886359691619,
        0.0367818474769592,
        0.0391283184289932,
        0.0397694408893585,
        0.04166841506958,
        0.045138344168663,
        0.0460735112428665,
        0.0470626205205917,
        0.0483012944459915,
        0.0509191304445266,
        0.0536801367998123,
        0.0555481761693954,
        0.0576392263174057,
        0.0586376041173934,
        0.0596504658460617,
        0.060066595673561,
        0.0597885102033615,
        0.0599275678396225,
        0.0599559396505355,
        0.059136614203453,
        0.0579413920640945,
        0.0557379573583602,
        0.0545461624860763,
        0.0537003427743911,
        0.0523606687784194,
        0.0510759800672531,
        0.0509651750326156,
        0.0503850728273391,
        0.0500956326723098,
        0.0502043515443801,
        0.049722746014595,
        0.0495305210351944,
        0.0494731813669204,
        0.0488550812005996,
        0.0492392927408218,
        0.0487017482519149,
        0.0485242754220962,
        0.0491975396871566,
        0.0491014868021011,
        0.0458092838525772,
        0.0528131276369094,
        0.0566350370645523,
        0.0566370338201522,
        0.0557525306940078,
        0.058584526181221,
        0.0587129145860672,
        0.0591174215078353,
        0.057425633072853,
        0.0574537366628646,
        0.0576222687959671,
        0.0583587139844894,
        0.0593044608831405,
        0.0594580322504043,
        0.0595420747995376,
        0.0599037855863571,
        0.0600292831659317,
        0.0602520257234573,
        0.059862270951271,
        0.0583338290452957,
        0.056570753455162,
        0.0546583086252212,
        0.0538825839757919,
        0.0532180517911911,
        0.0530655831098556,
        0.052665576338768,
        0.0517401546239852,
        0.0502224713563919,
        0.0471661537885665,
        0.0448027402162551,
        0.0422115325927734,
        0.0407059788703918,
        0.0394206792116165,
        0.0389423966407775,
        0.0399540066719055,
        0.0400086194276809,
        0.0394069254398345,
        0.0385458022356033,
        0.0391196310520172,
        0.0393516570329666,
        0.0400624275207519,
        0.0413901060819625,
        0.0430478304624557,
        0.045023962855339,
        0.0464392453432083,
        0.0491922050714492,
        0.0518960207700729,
        0.0537480860948562,
        0.0554499775171279,
        0.0577649921178817,
        0.0591395944356918,
        0.0611689835786819,
        0.0622268468141555,
        0.0627422481775283,
        0.0637871474027633,
        0.0641072541475296,
        0.0640379637479782,
        0.0650427788496017,
        0.065210148692131,
        0.0646100491285324,
        0.063968226313591,
        0.0638010054826736,
        0.0635783523321151,
        0.0626998394727706,
        0.0623795837163925,
        0.0621152371168136,
        0.0621009618043899,
        0.0626721531152725,
        0.0622406750917434,
        0.0618786066770553,
        0.0617393404245376,
        0.0607649534940719,
        0.0602089017629623,
        0.0599442273378372,
        0.0601104944944381,
        0.0594434291124343,
        0.0597762614488601,
        0.059025153517723,
        0.058122381567955,
        0.0574411302804946,
        0.0573431104421615,
        0.0561792403459548,
        0.0561786741018295,
        0.0555544942617416,
        0.0550834387540817,
        0.054585114121437,
        0.0537959784269332,
        0.0529120117425918,
        0.0527178198099136,
        0.0518751293420791,
        0.0509509593248367,
        0.0496952980756759,
        0.0498884171247482,
        0.0493649095296859,
        0.0489236265420913,
        0.0488410741090774,
        0.0492122620344162,
        0.049116626381874,
        0.0491154342889785,
        0.0482883304357528,
        0.0477914959192276,
        0.0522596389055252,
        0.0528136938810348,
        0.0509901791810989,
        0.0520960241556167,
        0.049490138888359,
        0.0451992899179458,
        0.0418398380279541,
        0.0391047596931457,
        0.0368259996175766,
        0.0359129458665847,
        0.0354361832141876,
        0.0353546887636184,
        0.0361450165510177,
        0.0371268093585968,
        0.0368402749300003,
        0.0375906825065612,
        0.0374950617551803,
        0.0380000174045562,
        0.0387649089097976,
        0.0398719757795333,
        0.0404874235391616,
        0.0420751571655273,
        0.0432671904563903,
        0.044734850525856,
        0.0478127747774124,
        0.0495608896017074,
        0.0510772913694381,
        0.0522358566522598,
        0.0536027997732162,
        0.0546530932188034,
        0.0552748888731002,
        0.0559524744749069,
        0.0558687299489975,
        0.0563942044973373,
        0.0566714853048324,
        0.0566432923078537,
        0.0564909130334854,
        0.0564070791006088,
        0.0557004064321517,
        0.0548983067274093,
        0.0549530833959579,
        0.0542616993188858,
        0.0539994090795517,
        0.0536809116601944,
        0.0534460991621017,
        0.0526727885007858,
        0.0530176013708114,
        0.0526704937219619,
        0.0525064915418624,
        0.0530715137720108,
        0.052754059433937,
        0.0527403801679611,
        0.0527669042348861,
        0.0530160516500473,
        0.0526431649923324,
        0.0526150614023208,
        0.0529879182577133,
        0.0522976964712142,
        0.052421435713768,
        0.0523105710744857,
        0.0519105941057205,
        0.0516207367181777,
        0.0509585887193679,
        0.0503794103860855,
        0.0494422167539596,
        0.0490015298128128,
        0.0480933934450149,
        0.0474058836698532,
        0.046965941786766,
        0.0465948730707168,
        0.0457299500703811,
        0.0458667129278183,
        0.0454409271478652,
        0.0451396256685256,
        0.0451389998197555,
        0.045276328921318,
        0.045249119400978,
        0.0451804548501968,
        0.0455504208803176,
        0.045454517006874,
        0.0456184297800064,
        0.0455368012189865,
        0.0454830378293991,
        0.0450443476438522,
        0.0436865836381912,
        0.0413589477539062,
        0.0391309708356857,
        0.0367843061685562,
        0.0354765057563781,
        0.0350819528102874,
        0.0349458903074264,
        0.0350550562143325,
        0.0355181396007537,
        0.035599797964096,
        0.0366357117891311,
        0.0366219729185104,
        0.037836268544197,
        0.038710281252861,
        0.0393114537000656,
        0.0408021062612533,
        0.0418424308300018,
        0.0436237305402755,
        0.0451602488756179,
        0.047014907002449,
        0.0482254475355148,
        0.0512564629316329,
        0.0528571754693985,
        0.0540172308683395,
        0.0553722530603408,
        0.0564238876104354,
        0.0569778531789779,
        0.0575029999017715,
        0.0574876219034194,
        0.0580008178949356,
        0.0579442232847213,
        0.0577634125947952,
        0.0566270500421524,
        0.0561837702989578,
        0.0549377650022506,
        0.0548967272043228,
        0.0542190819978714,
        0.0539005249738693,
        0.053513690829277,
        0.0531543046236038,
        0.0528649240732193,
        0.0526295155286788,
        0.0522984713315963,
        0.0522711724042892,
        0.0523394793272018,
        0.0523258000612258,
        0.0521330088376998,
        0.0525877326726913,
        0.0518286675214767,
        0.0523250252008438,
        0.0527524501085281,
        0.0526150614023208,
        0.052656814455986,
        0.0527524501085281,
        0.0528906732797622,
        0.0523804575204849,
        0.0527516156435012,
        0.0525732785463333,
        0.0521997064352035,
        0.0512611418962478,
        0.0506962388753891,
        0.0504058748483657,
        0.0498141199350357,
        0.0492771118879318,
        0.0484512597322464,
        0.0479420870542526,
        0.0478044301271438,
        0.0479413717985153,
        0.0471027940511703,
        0.0471164137125015,
        0.0472948104143142,
        0.0468964725732803,
        0.0473772436380386,
        0.0472260266542434,
        0.0474324077367782,
        0.0477205365896225,
        0.0479133874177932,
        0.0479557067155838,
        0.0483687669038772,
        0.0467615872621536,
        0.0445785373449325,
        0.0422210097312927,
        0.0393767356872558,
        0.0376433581113815,
        0.0366889536380767,
        0.0359945446252822,
        0.0354907810688018,
        0.0363493859767913,
        0.0359678268432617,
        0.0362404286861419,
        0.0373451113700866,
        0.0379319638013839,
        0.0388332605361938,
        0.0396121889352798,
        0.0402821749448776,
        0.0414726436138153,
        0.0426366329193115,
        0.0442405194044113,
        0.0459703356027603,
        0.0480322688817977,
        0.0502905398607254,
        0.0519864410161972,
        0.0529805570840835,
        0.0544585138559341,
        0.0550397187471389,
        0.0558397620916366,
        0.056518331170082,
        0.0564901083707809,
        0.056392565369606,
        0.0567794293165206,
        0.0556302815675735,
        0.0551044195890426,
        0.054577961564064,
        0.0531679838895797,
        0.0527950376272201,
        0.0520213991403579,
        0.0521322339773178,
        0.0504066795110702,
        0.0531132966279983,
        0.0528512746095657,
        0.051484927535057,
        0.0507940500974655,
        0.0518574863672256,
        0.052700862288475,
        0.0530874580144882,
        0.053351029753685,
        0.0534756332635879,
        0.0536550134420394,
        0.0536550134420394,
        0.0540015548467636,
        0.0544996410608291,
        0.0551212579011917,
        0.0547484010457992,
        0.0541103929281234,
        0.0542487949132919,
        0.0536816865205764,
        0.052602931857109,
        0.0519257932901382,
        0.0507940500974655,
        0.0502975434064865,
        0.049896702170372,
        0.0491809695959091,
        0.0481901913881301,
        0.047762855887413,
        0.046883538365364,
        0.0460728555917739,
        0.0453443676233291,
        0.0440136045217514,
        0.0445483177900314,
        0.045466735959053,
        0.0453987568616867,
        0.045508936047554,
        0.0460714846849441,
        0.0463736206293106,
        0.0460857897996902,
        0.0468269735574722,
        0.0470755547285079,
        0.0467057973146438,
        0.0457305759191513,
        0.0437138229608535,
        0.0416876673698425,
        0.0393495559692382,
        0.0384078323841095,
        0.0369485914707183,
        0.0366763472557067,
        0.0370856374502182,
        0.0376316010951995,
        0.0377408564090728,
        0.0388879030942916,
        0.0387103110551834,
        0.0388605594635009,
        0.0378364026546478,
        0.0361172407865524,
        0.0445433109998703,
        0.0452983826398849,
        0.0438022464513778,
        0.041225790977478,
        0.0445970743894577,
        0.0494793802499771,
        0.051713541150093,
        0.052830770611763,
        0.0540881305932998,
        0.0562754720449447,
        0.0577994436025619,
        0.0593946427106857,
        0.0599354654550552,
        0.0612555593252182,
        0.0622854083776474,
        0.0623275488615036,
        0.0621048063039779,
        0.0601836889982223,
        0.0576563030481338,
        0.054856464266777,
        0.0539005249738693,
        0.0526150614023208,
        0.052421435713768,
        0.0530570596456527,
        0.0539005249738693,
        0.0539841800928115,
        0.0545095652341842,
        0.0548967272043228,
        0.054661676287651,
        0.0550899058580398,
        0.0547582656145095,
        0.0548274964094162,
        0.0547993034124374,
        0.0549642294645309,
        0.0551027208566665,
        0.0548539906740188,
        0.055212989449501,
        0.0549232214689254,
        0.0551164001226425,
        0.0552958995103836,
        0.0550334900617599,
        0.055351510643959,
        0.0550189167261123,
        0.0548813492059707,
        0.0542310923337936,
        0.0538441687822341,
        0.0524061173200607,
        0.0526969879865646,
        0.0515516847372055,
        0.051041230559349,
        0.0500762611627578,
        0.0493194907903671,
        0.0490022748708725,
        0.0484921485185623,
        0.0472962409257888,
        0.0474753826856613,
        0.0475571304559707,
        0.0472962409257888,
        0.0474610775709152,
        0.0475714355707168,
        0.0466240495443344,
        0.0483967512845993,
        0.0482454150915145,
        0.0480402261018753,
        0.0487833768129348,
        0.0489497333765029,
        0.0423422753810882,
        0.0510318428277969,
        0.0516444891691207,
        0.0455173105001449,
        0.0416228771209716,
        0.0395165085792541,
        0.0363765805959701,
        0.036553680896759,
        0.0385868698358535,
        0.0416633486747741,
        0.043005958199501,
        0.0441993027925491,
        0.0458060055971145,
        0.0465482026338577,
        0.0479379743337631,
        0.0495913475751876,
        0.0513434559106826,
        0.0528906434774398,
        0.05535389482975,
        0.0575305372476577,
        0.0592385381460189,
        0.0608653575181961,
        0.0607400089502334,
        0.0633582919836044,
        0.0647245496511459,
        0.0650309473276138,
        0.0652952343225479,
        0.0654335469007492,
        0.0659076422452926,
        0.0650412291288375,
        0.0650400966405868,
        0.0649143010377883,
        0.0655421763658523,
        0.0677358955144882,
        0.07076396048069,
        0.0736182183027267,
        0.072621151804924,
        0.0715550035238266,
        0.0707558840513229,
        0.0712756365537643,
        0.0718095153570175,
        0.0732994228601455,
        0.0744390338659286,
        0.075424924492836,
        0.075453296303749,
        0.075467362999916,
        0.0750449448823928,
        0.0749462395906448,
        0.074158027768135,
        0.0732154697179794,
        0.0717397779226303,
        0.0699992924928665,
        0.0675619393587112,
        0.0664281398057937,
        0.0664695054292678,
        0.066664919257164,
        0.0669298619031906,
        0.0662029832601547,
        0.0652249604463577,
        0.0645263940095901,
        0.0637450963258743,
        0.0624483674764633,
        0.0609032660722732,
        0.0597210079431533,
        0.059067502617836,
        0.057942196726799,
        0.0572768300771713,
        0.0565419942140579,
        0.0560847967863082,
        0.0556273311376571,
        0.0555718392133712,
        0.055267259478569,
        0.0553498417139053,
        0.0553085356950759,
        0.0553085356950759,
        0.055516317486763,
        0.0560283809900283,
        0.0555713921785354,
        0.0555438548326492,
        0.0545061379671096,
        0.0542297214269638,
        0.0522258430719375,
        0.0501696318387985,
        0.0479521602392196,
        0.0458482354879379,
        0.0451065152883529,
        0.0442004650831222,
        0.0444199293851852,
        0.045023962855339,
        0.0448451191186904,
        0.0447900742292404,
        0.0456005185842514,
        0.0457652658224105,
        0.046411320567131,
        0.0471129864454269,
        0.048035129904747,
        0.0485309213399887,
        0.0501158386468887,
        0.0514540821313858,
        0.0533467084169387,
        0.0554637759923934,
        0.057514801621437,
        0.0584164410829544,
        0.0599019080400466,
        0.0602767616510391,
        0.0612497776746749,
        0.0615414828062057,
        0.0619442909955978,
        0.0616099685430526,
        0.0622775107622146,
        0.0622768849134445,
        0.0622768849134445,
        0.061441883444786,
        0.0613860934972763,
    ];

    let low_cutoff: Hertz<f32> = 4.hz();
    let high_cutoff: Hertz<f32> = 50.hz();
    let cutoff_freq: Hertz<f32> = 200.0.hz();
    let sample_rate: Hertz<f32> = 100.hz();

    let float_vector1: RawData = RawData::FloatVec(signal);
    let float_vector1clone: RawData = float_vector1.clone();

    //IIR FILTERS AND MOVING AVERAGE FILTER
    let mut lowpass_filter =
        iir::lowpass::butterworth::BiquadButterworth::new(low_cutoff, sample_rate);
    let mut lowpass_filter =
        iir::lowpass::butterworth::BiquadButterworth::new(low_cutoff, sample_rate);

    let mut highpass_filter =
        iir::highpass::butterworth::BiquadButterworth::new(high_cutoff, sample_rate);
    let mut highpass_filter =
        iir::highpass::butterworth::BiquadButterworth::new(high_cutoff, sample_rate);

    let mut moving_average_filter =
        iir::moving_average::moving_average_filter::MovingAverageFilter::new();

    let mut notch_filter =
        iir::notch::butterworth::BiquadButterworth::new(high_cutoff, low_cutoff, sample_rate);

    c.bench_function("lowpass_filter_warmup", |b| {
        b.iter(|| lowpass_filter.warmup(&float_vector1))
    });

    c.bench_function("lowpass_filter_filtfilt", |b| {
        b.iter(|| lowpass_filter.filtfilt(float_vector1.clone()))
    });

    c.bench_function("highpass_filter_warmup", |b| {
        b.iter(|| highpass_filter.warmup(&float_vector1))
    });

    c.bench_function("highpass_filter_filtfilt", |b| {
        b.iter(|| highpass_filter.filtfilt(float_vector1.clone()))
    });

    c.bench_function("moving_average_filter_process", |b| {
        b.iter(|| moving_average_filter.process(&float_vector1))
    });

    c.bench_function("notch_filter_filtfilt", |b| {
        b.iter(|| notch_filter.process(float_vector1.clone()))
    });

    //MATH FUNCTIONS

    c.bench_function("average_function", |b| {
        b.iter(|| Math::average(&float_vector1))
    });

    c.bench_function("normalizing_avg_function", |b| {
        b.iter(|| Math::normalizing_avg(&float_vector1))
    });

    c.bench_function("calculate_z_function", |b| {
        b.iter(|| Math::calculate_zscore(&float_vector1))
    });

    c.bench_function("min_max_function", |b| {
        b.iter(|| Math::min_and_max(&float_vector1))
    });

    //FFT

    let mut fft_filter = Fft::new();

    c.bench_function("fft_forward_real", |b| {
        b.iter(|| fft_filter.run_forward_real(&float_vector1))
    });

    c.bench_function("fft_forward_imag", |b| {
        b.iter(|| fft_filter.run_forward_imag(&float_vector1))
    });

    c.bench_function("fft_inverse_real", |b| {
        b.iter(|| fft_filter.run_inverse_real(&float_vector1))
    });

    c.bench_function("fft_inverse_imag", |b| {
        b.iter(|| fft_filter.run_inverse_imag(&float_vector1))
    });

    //DATA RESAMPLING
    let resampling_data: RawData = RawData::FloatVec(vec![
        57.42375095409937,
        56.93672522014874,
        62.608713592930876,
        58.58999011614217,
        53.781514473465975,
        59.929765521680004,
        62.83874316763905,
        61.26564682933764,
        60.298077069774514,
        65.69037167656037,
        64.4924856859658,
        57.45776902834044,
        67.2979270744406,
        64.3065399558438,
        69.10913177362237,
        69.68135328937724,
        66.27441648596799,
        66.5712753857469,
        68.7197206786976,
        66.77069404089671,
        69.47343229079385,
        73.49687241835524,
        74.39038713833476,
        69.77134706156811,
        71.11611036527033,
        71.5514143700266,
        70.92527568110486,
        75.81690366006418,
        71.48430850738842,
        73.99189451125514,
        77.46501916351879,
        75.58651101737665,
        78.48004995555802,
        75.23963596784876,
        80.30163806050568,
        77.62973765421143,
        80.16175629224077,
        80.68837591441441,
        79.6905673290241,
        83.3649494980984,
        83.41729893388869,
        81.27997708388136,
        82.92243382684352,
        83.78103585804621,
        83.22618159997842,
        84.46526224102954,
        84.07977328452601,
        81.7653661597366,
        83.24232423541409,
        82.98821921592604,
        84.52930477159329,
        86.00457616832857,
        84.85465642598282,
        79.6146939926643,
        83.91264690823981,
        84.58107619775576,
        86.86586732593057,
        86.87782780765482,
        86.49708394674948,
        84.66183307481079,
        83.32273574233504,
        89.75815463910952,
        81.73921292290746,
        83.57667052875678,
        82.29154311686115,
        81.15090505024507,
        81.0181809858243,
        80.02406477550639,
        79.95626138939767,
        80.14968471195097,
        77.93833929477205,
        83.37140263453084,
        80.63006474812504,
        80.54886758093564,
        74.61328386499513,
        76.2067956336496,
        75.93496294510105,
        74.80986359211977,
        79.09967283013746,
        73.35452123905561,
        76.43997860290371,
        73.37084091593962,
        72.27187673807346,
        76.47512075935063,
        73.51588873047531,
        74.04609287428879,
        73.5220350777692,
        71.2657426722753,
        69.51314201809633,
        70.77160782734013,
        68.74978122247276,
        71.97834832913482,
        68.52537097152933,
        68.24617406288941,
        69.73725303822009,
        70.11807598587777,
        69.35509863639831,
        69.47650042355208,
        66.64598319409271,
        68.3345766746571,
        66.2569569225079,
        66.38695004387625,
        58.302036498704005,
        59.823489245315685,
        63.90206250674178,
        67.44946967703007,
        64.55800828600442,
        64.17137953752636,
        64.24996006660133,
        64.60722809289496,
        62.715507684022455,
        62.10266642672423,
        62.987139113750466,
        62.56118234068753,
        60.74277369885567,
        61.304485787724424,
        63.39768612316597,
        59.17504593185429,
        60.92293919145394,
        61.74329340412283,
        57.66140451493842,
        62.09807476069308,
        61.33026367110421,
        59.73879796926617,
        58.5720628991695,
        59.94647404967808,
        62.000588448844795,
        60.33024266169896,
        60.98985504062868,
        58.65602786741151,
        59.89716687482642,
        57.61316051537118,
        57.166505274132426,
        58.96556719641834,
        60.37679949619507,
        54.45584180986487,
        58.7271982420652,
        59.47366447708427,
        56.07940328686498,
        55.78066887807596,
        54.54564631742577,
        54.52126114421135,
        56.12296587524522,
        55.80474208024708,
        55.450268698368774,
        53.6860047610941,
        56.265818477761954,
        51.87808742443517,
        54.7399559253531,
        56.05143364518187,
        52.41066187331751,
        49.34598557487828,
        50.79534970301276,
        50.994619031875516,
        54.5066732568543,
        45.641877225921085,
        45.44783149223058,
        49.71813811826957,
        49.06417606679746,
        48.47113041190944,
        45.066752680131536,
        45.691797364781955,
        46.04972969161036,
        46.937126956810964,
        48.579890629805696,
        46.87831648338302,
        43.2621571874902,
        42.41539084532762,
        47.732792000519055,
        42.635078585330035,
        45.25466510897015,
        44.20457419707335,
        39.80087116943825,
        43.16784163357121,
        42.72139421919673,
        40.09690411968018,
        39.072075680860785,
        39.68721522523129,
        39.69694747954145,
        38.89958622251241,
        36.20930810783846,
        38.54348444090701,
        39.49315655173681,
        37.22306536922959,
        38.45119902245094,
        38.36169803033943,
        36.27817076033729,
        38.495487020334416,
        36.08203266391632,
        35.61234698124961,
        37.31850254780822,
        35.73508343583559,
        34.24509993239897,
        38.21302621383962,
        35.21073369085666,
        34.7557606412574,
        38.30832823832005,
        37.01263245066287,
        38.27243482312153,
        35.10563354463935,
        36.54702691361821,
        37.496545142093524,
        40.21495219978659,
        33.4472745629568,
        36.19003918456128,
        40.40279302834972,
        39.782856300732334,
        38.65349615550868,
        39.553456446758894,
        43.1239603503975,
        38.65895285386617,
        41.549607795356614,
        41.87845934752343,
        41.252783475633485,
        41.294266760442,
        42.2846785280957,
        45.66429780888518,
        48.37613972205177,
        45.184550578912244,
        45.83903707029868,
        50.45023663869127,
        47.807444589854164,
        49.6770059662178,
        47.06600589312027,
        50.35579734602591,
        45.08336916260292,
        48.369671422972786,
        50.56098595974319,
        50.60044633370852,
        54.91737419172761,
        55.587993290196444,
        51.32300551457022,
        54.80025666186663,
        51.74767705510797,
        54.84209797727291,
        56.02482448641735,
        55.61823652859607,
        58.55601631729386,
        60.72812364016489,
        58.75761743767916,
        59.151794377943254,
        59.22341098206529,
        63.837931340247394,
        61.3622177601643,
        62.552959520063325,
        62.90488582386602,
        64.7298637786503,
        64.29580055208083,
        67.19411603468367,
    ]);

    let mut resampler_filter = DataResampling::new();

    c.bench_function("resampling_by_avg", |b| {
        b.iter(|| resampler_filter.resampling_by_average(&resampling_data.clone(), 33.0, 100.0))
    });

    let mut resampler_filter = DataResampling::new();
    c.bench_function("resampling_by_incremenet", |b| {
        b.iter(|| resampler_filter.resampling_by_increment(&resampling_data.clone(), 33.0, 100.0))
    });

    //PEAK FINDER
    let mut peak_finder_filter = PeakFinder::new();
    let input_signal1: RawData = RawData::FloatVec(vec![
        57.42375095409937,
        56.93672522014874,
        62.608713592930876,
        58.58999011614217,
        53.781514473465975,
        59.929765521680004,
        62.83874316763905,
        61.26564682933764,
        60.298077069774514,
        65.69037167656037,
        64.4924856859658,
        57.45776902834044,
        67.2979270744406,
        64.3065399558438,
        69.10913177362237,
        69.68135328937724,
        66.27441648596799,
        66.5712753857469,
        68.7197206786976,
        66.77069404089671,
        69.47343229079385,
        73.49687241835524,
        74.39038713833476,
        69.77134706156811,
        71.11611036527033,
        71.5514143700266,
        70.92527568110486,
        75.81690366006418,
        71.48430850738842,
        73.99189451125514,
        77.46501916351879,
        75.58651101737665,
        78.48004995555802,
        75.23963596784876,
        80.30163806050568,
        77.62973765421143,
        80.16175629224077,
        80.68837591441441,
        79.6905673290241,
        83.3649494980984,
        83.41729893388869,
        81.27997708388136,
        82.92243382684352,
        83.78103585804621,
        83.22618159997842,
        84.46526224102954,
        84.07977328452601,
        81.7653661597366,
        83.24232423541409,
        82.98821921592604,
        84.52930477159329,
        86.00457616832857,
        84.85465642598282,
        79.6146939926643,
        83.91264690823981,
        84.58107619775576,
        86.86586732593057,
        86.87782780765482,
        86.49708394674948,
        84.66183307481079,
        83.32273574233504,
        89.75815463910952,
        81.73921292290746,
        83.57667052875678,
        82.29154311686115,
        81.15090505024507,
        81.0181809858243,
        80.02406477550639,
        79.95626138939767,
        80.14968471195097,
        77.93833929477205,
        83.37140263453084,
        80.63006474812504,
        80.54886758093564,
        74.61328386499513,
        76.2067956336496,
        75.93496294510105,
        74.80986359211977,
        79.09967283013746,
        73.35452123905561,
        76.43997860290371,
        73.37084091593962,
        72.27187673807346,
        76.47512075935063,
        73.51588873047531,
        74.04609287428879,
        73.5220350777692,
        71.2657426722753,
        69.51314201809633,
        70.77160782734013,
        68.74978122247276,
        71.97834832913482,
        68.52537097152933,
        68.24617406288941,
        69.73725303822009,
        70.11807598587777,
        69.35509863639831,
        69.47650042355208,
        66.64598319409271,
        68.3345766746571,
        66.2569569225079,
        66.38695004387625,
        58.302036498704005,
        59.823489245315685,
        63.90206250674178,
        67.44946967703007,
        64.55800828600442,
        64.17137953752636,
        64.24996006660133,
        64.60722809289496,
        62.715507684022455,
        62.10266642672423,
        62.987139113750466,
        62.56118234068753,
        60.74277369885567,
        61.304485787724424,
        63.39768612316597,
        59.17504593185429,
        60.92293919145394,
        61.74329340412283,
        57.66140451493842,
        62.09807476069308,
        61.33026367110421,
        59.73879796926617,
        58.5720628991695,
        59.94647404967808,
        62.000588448844795,
        60.33024266169896,
        60.98985504062868,
        58.65602786741151,
        59.89716687482642,
        57.61316051537118,
        57.166505274132426,
        58.96556719641834,
        60.37679949619507,
        54.45584180986487,
        58.7271982420652,
        59.47366447708427,
        56.07940328686498,
        55.78066887807596,
        54.54564631742577,
        54.52126114421135,
        56.12296587524522,
        55.80474208024708,
        55.450268698368774,
        53.6860047610941,
        56.265818477761954,
        51.87808742443517,
        54.7399559253531,
        56.05143364518187,
        52.41066187331751,
        49.34598557487828,
        50.79534970301276,
        50.994619031875516,
        54.5066732568543,
        45.641877225921085,
        45.44783149223058,
        49.71813811826957,
        49.06417606679746,
        48.47113041190944,
        45.066752680131536,
        45.691797364781955,
        46.04972969161036,
        46.937126956810964,
        48.579890629805696,
        46.87831648338302,
        43.2621571874902,
        42.41539084532762,
        47.732792000519055,
        42.635078585330035,
        45.25466510897015,
        44.20457419707335,
        39.80087116943825,
        43.16784163357121,
        42.72139421919673,
        40.09690411968018,
        39.072075680860785,
        39.68721522523129,
        39.69694747954145,
        38.89958622251241,
        36.20930810783846,
        38.54348444090701,
        39.49315655173681,
        37.22306536922959,
        38.45119902245094,
        38.36169803033943,
        36.27817076033729,
        38.495487020334416,
        36.08203266391632,
        35.61234698124961,
        37.31850254780822,
        35.73508343583559,
        34.24509993239897,
        38.21302621383962,
        35.21073369085666,
        34.7557606412574,
        38.30832823832005,
        37.01263245066287,
        38.27243482312153,
        35.10563354463935,
        36.54702691361821,
        37.496545142093524,
        40.21495219978659,
        33.4472745629568,
        36.19003918456128,
        40.40279302834972,
        39.782856300732334,
        38.65349615550868,
        39.553456446758894,
        43.1239603503975,
        38.65895285386617,
        41.549607795356614,
        41.87845934752343,
        41.252783475633485,
        41.294266760442,
        42.2846785280957,
        45.66429780888518,
        48.37613972205177,
        45.184550578912244,
        45.83903707029868,
        50.45023663869127,
        47.807444589854164,
        49.6770059662178,
        47.06600589312027,
        50.35579734602591,
        45.08336916260292,
        48.369671422972786,
        50.56098595974319,
        50.60044633370852,
        54.91737419172761,
        55.587993290196444,
        51.32300551457022,
        54.80025666186663,
        51.74767705510797,
        54.84209797727291,
        56.02482448641735,
        55.61823652859607,
        58.55601631729386,
        60.72812364016489,
        58.75761743767916,
        59.151794377943254,
        59.22341098206529,
        63.837931340247394,
        61.3622177601643,
        62.552959520063325,
        62.90488582386602,
        64.7298637786503,
        64.29580055208083,
        67.19411603468367,
    ]);

    let input_signal1clone = input_signal1.clone();

    let minimum_height: f32 = 2.0;
    let maximum_height: f32 = 50.0;
    let minimum_prominence: f32 = 2.0;
    let minimum_distance: f32 = 4.0;
    let minimum_plateau_size = 1.0;
    let maximum_prominence: f32 = 4.0;

    c.bench_function("peak_finder_filter", |b| {
        b.iter(|| peak_finder_filter.run_peakfinder(&input_signal1))
    });

    c.bench_function("peak_finder_filter_minhp", |b| {
        b.iter(|| {
            peak_finder_filter.run_peakfinder_min_hp(
                &input_signal1clone.clone(),
                minimum_height,
                minimum_prominence,
            )
        })
    });

    c.bench_function("peak_finder_filter_minhp", |b| {
        b.iter(|| {
            peak_finder_filter.run_peakfinder_min_hdp(
                &input_signal1clone.clone(),
                minimum_height,
                minimum_distance,
                minimum_plateau_size,
            )
        })
    });

    c.bench_function("peak_finder_filter_minmax_hp", |b| {
        b.iter(|| {
            peak_finder_filter.run_peakfinder_min_hp_max_hp(
                &input_signal1clone.clone(),
                minimum_height,
                minimum_prominence,
                maximum_height,
                maximum_prominence,
            )
        })
    });

    //WINDOWING

    let float_vector1 = RawData::FloatVec(vec![6.2, 7.1, 6.2]); //windowing
    let float_vector2 = RawData::FloatVec(vec![1.0; 3]); //rectangular
    let float_vector3: RawData = RawData::FloatVec(vec![1.0; 5]); // blackman, hamming, hann, welch, sine

    c.bench_function("windowing", |b| {
        b.iter(|| Windowing::windowing(&float_vector1, 2))
    });
    c.bench_function("windowing_rectangular", |b| {
        b.iter(|| Windowing::rectangular(&float_vector2, 3))
    });
    c.bench_function("windowing_blackman", |b| {
        b.iter(|| Windowing::blackman(&float_vector3.clone(), 5))
    });
    c.bench_function("windowing_hamming", |b| {
        b.iter(|| Windowing::hamming(&float_vector3.clone(), 5))
    });
    c.bench_function("windowing_hann", |b| {
        b.iter(|| Windowing::hann(&float_vector3.clone(), 5))
    });
    c.bench_function("windowing_welch", |b| {
        b.iter(|| Windowing::welch(&float_vector3.clone(), 5))
    });
    c.bench_function("windowing_sine", |b| {
        b.iter(|| Windowing::sine(&float_vector3.clone(), 5))
    });
    c.bench_function("windowing_triangular", |b| {
        b.iter(|| Windowing::triangular(&float_vector3.clone(), 5))
    });
}

criterion_group!(benches, criterion_benchmark);
criterion_main!(benches);
