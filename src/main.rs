pub mod mods;
use core::time;
use std::time::Instant;
use std::vec;
use funspace::chebyshev::ortho::Chebyshev;
use ndarray::Array1;
use mods::datatype::RawData;
use mods::math::Math;
use mods::digital_filters::fir;
use mods::digital_filters::iir::{bandpass,lowpass,highpass,moving_average,notch};
use mods::fast_fourier_transform::Fft;
use mods::data_resampling::DataResampling;
use mods::peak_finder::PeakFinder;
use mods::windowing::Windowing;
//use mods::short_time_fourier_transform::stft;

use biquad::*;

use crate::mods::digital_filters::iir::moving_average::moving_average_filter;




 fn main() {


  let low_cutoff: Hertz<f32> = 10.hz();
  let high_cutoff: Hertz<f32>  = 50.hz();
  let cutoff_freq: Hertz<f32> = 200.0.hz();
  let sample_rate: Hertz<f32> = 1000.hz();
  

  let signal: Vec<f32> = vec![63.99092630573587, 66.93696212356637, 70.21186315215436, 72.36973560013404, 71.11691135495082, 72.63754606973377, 72.65395183291722, 75.30769614499027, 72.34117224206321, 77.94792439244716, 73.93653252960603, 73.16497446824744, 74.65046589424942, 76.60137059484963, 77.17220449634708, 75.17682133758099, 76.48440991268191, 69.78105590076562, 77.75759492612978, 76.76624671261732, 75.05522885106886, 74.8900271929814, 78.24017247168905, 74.7911936054381, 73.93608544656938, 75.67611078132667, 73.87176381605543, 72.1317125984629, 74.19877370154555, 72.07262313345595, 66.16883909800117, 68.1234902846226, 67.9940521390197, 65.42287053804934, 62.365956284123406, 60.04226883410055, 60.37717874300646, 55.53905436534224, 52.789704377060225, 50.37831112573574, 50.09561898488419, 46.93412132002783, 42.11709863850101, 39.76188683251867, 38.176357058481294, 37.21377515533896, 36.57319371907161, 37.86710474449615, 37.51110302251426, 38.01662204416805, 35.12063062871996, 37.68283006198349, 39.143206292654284, 38.60738557046368, 41.31484490676405, 41.220896579006194, 40.09217525798975, 43.67250050799976, 48.16500030176038, 49.7101714366566, 49.582736715378154, 52.849703260421485, 54.287539988359256, 56.09883494119873, 61.251691546334854, 64.33828157245358, 62.27228748630153, 67.36046250199826, 69.51407928634843, 67.89944661604514, 70.94101282412565, 68.54096316500365, 73.40703302077047, 74.16412190109143, 71.58386452207274, 74.37321161593195, 76.17570392004909, 74.95815925469977, 73.04582603985054, 75.49199300610965, 74.65308833683778, 74.87414470359361, 77.33256788202083, 75.90883899498165, 76.36509000999601, 74.22920625532309, 73.79628679837059, 73.8495207513345, 78.33929484818184, 71.63706577736632, 72.82496818713668, 73.03871088309309, 72.21305640010098, 72.97719010877614, 71.61501898999207, 74.31052317335187, 67.02612175608851, 66.58828615058007, 68.62452187014583, 66.1958948289469];
  let signal: Vec<f32> = vec![-1.9683332331608474, -1.717858749355179, -3.759961365429422, -4.958623529379432, -5.485220603297286, -5.068780129646672, -4.96318014526072, -4.885967921675111, -5.829251675123736, -5.47186926387927, -4.047547235539912, -2.603374446559637, -3.946247752610877, -2.524435539984913, -1.797839878650658, -1.1220409621672651, 1.6720838919353374, 1.6955798780859315, 2.343381110638523, 3.218182666426548, 4.358122202583721, 4.765740984503017, 5.3746528409941625, 5.473490191594698, 5.4459250607079674, 4.222194023309575, 3.5631737543611535, 3.209953535535739, 2.2679968750567174, 1.689690757910821, -0.597044682792282, 1.2295096458344235, -0.5099352431494522, 0.47697194842395163, -2.3072239466746938, -3.042292567304973, -3.0447360037997395, -4.4776430466367305, -3.754204593262017, -6.087502919033549, -6.871119514379643, -4.411786302246042, -4.250411245136818, -4.024648954752383, -2.0401752910605495, -1.612949159415131, -2.3769865860842545, -3.15653998158343, -1.7163347916741254, 0.041943799144170235, 1.9018582516181133, 3.2137686101959435, 5.1216168049167985, 5.181272248816972, 4.177162647343236, 4.910559911650967, 5.430561901903032, 4.914839631100418, 4.082933712117779, 4.125764189831912, 3.7388394862747076, 3.7039793267104413, 3.4453653760211003, 1.1568404633907297, 1.1097420809409058, -0.8366844407434536, 0.00032929428028360963, -3.0127224874629523, -3.196935686912258, -4.808196244200207, -2.427739953054134, -5.288749141528557, -5.618464881445853, -3.662019379370501, -3.6482452220249724, -5.135757449930187, -4.660772381705265, -3.181033464835836, -2.183318478654945, -2.3096138598753755, -1.2072178300697296, 0.004073366967373482, 0.7634358906696369, 1.628489695396944, 1.9386947863288453, 2.8495583435889706, 5.59416091360117, 5.735551370915663, 3.5437303978327774, 4.885360913010343, 5.694246040053638, 5.902074521402208, 2.9898795350334995, 4.082546886152893, 4.420324680868482, 2.121238103640503, 1.5554249240012745, 1.0624173628602152, -0.3805941604330543, 0.00011955967508203713, -0.2726198877084691, -3.621165345065073, -2.3106682155706144, -3.008464055318883, -3.6791882243878735, -4.681285864712197, -3.6334225993506166, -4.216214656199944, -3.4899568532177225, -3.548036363731245, -2.886494585475302, -4.936660352815803, -2.590725789953134, -0.9882265278389202, -1.9279100219395602, -1.6026134543636394, 0.02413537999056925, 2.228901718042568, 1.322235456219919, 2.8494026435100954, 3.296661931119425, 6.027538285328892, 4.415979085282228, 5.1100437331543205, 6.295100814736361, 4.157654148903779, 3.8250625551763227, 3.210057612689865, 3.7263865243097665, 2.8724625295607904, 2.548551211873285, -0.7489415406426848, -0.22617745492874, -2.4690964140781864, -3.1401384827052907, -2.95160194936303, -3.968833387736624, -3.2246928010573304, -4.339702569114829, -4.609928246384497, -5.523486704135764, -4.33018351888759, -4.513375833855275, -5.613725875069774, -2.368110485069924, -4.174489468416508, -1.5462599231221796, -1.9112933863303545, -0.7448649061967919, -0.8100404653366764, 1.578768228660318, 3.0605698950709415, 4.481529255021599, 3.4321456403958956, 4.286162492840878, 3.542600865086815, 3.9863354311677752, 4.757085954129289, 4.696489704364847, 4.918603410598548, 3.5493191430519846, 3.666916622021471, 2.649908498384805, -0.7993657203092499, 1.7223957104697152, -1.5785502884870446, -1.5507321245573968, -2.3615494902364422, -1.9385720891906806, -3.30170673067445, -5.686723548491335, -5.69901727429125, -5.582951744522848, -6.659112241922954, -3.835897601355358, -5.404322318188626, -5.3489078376148065, -3.838447935719378, -3.6260649126217097, -3.2306088202096084, -1.0770129610851251, -0.25261828030183275, -1.2157559997094975, 1.9728883910883366, 2.069412523961515, 2.1302651705641797, 3.2818606629781093, 4.648235095453058, 4.345624826872002, 5.311056201049992, 5.753972583478267, 4.966966878966292, 5.687377769469735, 3.378594641228816, 3.724746520942307, 2.5068869273448637, 2.089416643652524, 2.2244325828483476, -1.5274374320264439, -1.5562495323100167, -0.6125119612628858, -2.423479614297431, -3.6936008895358454, -4.388813740752571, -2.854611911820127, -4.826404632800256, -4.572934893501845, -5.256601167670888, -4.099462848728823, -4.33604478745585, -4.816704386332135, -3.4583268405428713, -2.8384466420435683, -1.5125591619739749, -1.7625812266917775, 1.0157214852397545, 1.5095445502150102, 1.870631826947684, 2.0939755781446716, 1.5856545844653414, 2.58196547285172, 3.39753579431135, 5.264149506436597, 5.5893111966405895, 5.532014566927438, 4.3734134489260255, 6.189493491686161, 3.900783751807012, 3.5865611492307488, 0.6888304097686788, 0.10865269854412674, 0.9240575679009976, -0.7873680813469807, -2.7703355600198663, -1.9661351740983313, -3.508800442837363, -1.8306811210565046, -6.640595521684698, -4.777744190652245, -2.7724811787230283, -4.5073250427912415, -6.150295867603678, -3.5490954433689246, -4.787850673669156, -3.591325707404745, -1.0202459490603868, -2.330610271053504, -0.4834974609738696];      

  let float_vector1: RawData = RawData::FloatVec(signal);

  let mut filter = notch::butterworth::BiquadButterworth::new(high_cutoff, low_cutoff, sample_rate);


  let output = filter.process(float_vector1);


  print!("{:?}", output)





//   let n_taps = 5;
//   let cutoff1 = 0.2;
//   let cutoff2 = 0.4;

//   let mut filter = fir::highpass::FirHighpass::new(n_taps, cutoff1);

//   let output: Vec<f32> = filter.filtfilt(float_vector1);

//   println!("{:?}",output)

//  }


  // let signal: Vec<f32> = vec![-1.9683332331608474, -1.717858749355179, -3.759961365429422, -4.958623529379432, -5.485220603297286, -5.068780129646672, -4.96318014526072, -4.885967921675111, -5.829251675123736, -5.47186926387927, -4.047547235539912, -2.603374446559637, -3.946247752610877, -2.524435539984913, -1.797839878650658, -1.1220409621672651, 1.6720838919353374, 1.6955798780859315, 2.343381110638523, 3.218182666426548, 4.358122202583721, 4.765740984503017, 5.3746528409941625, 5.473490191594698, 5.4459250607079674, 4.222194023309575, 3.5631737543611535, 3.209953535535739, 2.2679968750567174, 1.689690757910821, -0.597044682792282, 1.2295096458344235, -0.5099352431494522, 0.47697194842395163, -2.3072239466746938, -3.042292567304973, -3.0447360037997395, -4.4776430466367305, -3.754204593262017, -6.087502919033549, -6.871119514379643, -4.411786302246042, -4.250411245136818, -4.024648954752383, -2.0401752910605495, -1.612949159415131, -2.3769865860842545, -3.15653998158343, -1.7163347916741254, 0.041943799144170235, 1.9018582516181133, 3.2137686101959435, 5.1216168049167985, 5.181272248816972, 4.177162647343236, 4.910559911650967, 5.430561901903032, 4.914839631100418, 4.082933712117779, 4.125764189831912, 3.7388394862747076, 3.7039793267104413, 3.4453653760211003, 1.1568404633907297, 1.1097420809409058, -0.8366844407434536, 0.00032929428028360963, -3.0127224874629523, -3.196935686912258, -4.808196244200207, -2.427739953054134, -5.288749141528557, -5.618464881445853, -3.662019379370501, -3.6482452220249724, -5.135757449930187, -4.660772381705265, -3.181033464835836, -2.183318478654945, -2.3096138598753755, -1.2072178300697296, 0.004073366967373482, 0.7634358906696369, 1.628489695396944, 1.9386947863288453, 2.8495583435889706, 5.59416091360117, 5.735551370915663, 3.5437303978327774, 4.885360913010343, 5.694246040053638, 5.902074521402208, 2.9898795350334995, 4.082546886152893, 4.420324680868482, 2.121238103640503, 1.5554249240012745, 1.0624173628602152, -0.3805941604330543, 0.00011955967508203713, -0.2726198877084691, -3.621165345065073, -2.3106682155706144, -3.008464055318883, -3.6791882243878735, -4.681285864712197, -3.6334225993506166, -4.216214656199944, -3.4899568532177225, -3.548036363731245, -2.886494585475302, -4.936660352815803, -2.590725789953134, -0.9882265278389202, -1.9279100219395602, -1.6026134543636394, 0.02413537999056925, 2.228901718042568, 1.322235456219919, 2.8494026435100954, 3.296661931119425, 6.027538285328892, 4.415979085282228, 5.1100437331543205, 6.295100814736361, 4.157654148903779, 3.8250625551763227, 3.210057612689865, 3.7263865243097665, 2.8724625295607904, 2.548551211873285, -0.7489415406426848, -0.22617745492874, -2.4690964140781864, -3.1401384827052907, -2.95160194936303, -3.968833387736624, -3.2246928010573304, -4.339702569114829, -4.609928246384497, -5.523486704135764, -4.33018351888759, -4.513375833855275, -5.613725875069774, -2.368110485069924, -4.174489468416508, -1.5462599231221796, -1.9112933863303545, -0.7448649061967919, -0.8100404653366764, 1.578768228660318, 3.0605698950709415, 4.481529255021599, 3.4321456403958956, 4.286162492840878, 3.542600865086815, 3.9863354311677752, 4.757085954129289, 4.696489704364847, 4.918603410598548, 3.5493191430519846, 3.666916622021471, 2.649908498384805, -0.7993657203092499, 1.7223957104697152, -1.5785502884870446, -1.5507321245573968, -2.3615494902364422, -1.9385720891906806, -3.30170673067445, -5.686723548491335, -5.69901727429125, -5.582951744522848, -6.659112241922954, -3.835897601355358, -5.404322318188626, -5.3489078376148065, -3.838447935719378, -3.6260649126217097, -3.2306088202096084, -1.0770129610851251, -0.25261828030183275, -1.2157559997094975, 1.9728883910883366, 2.069412523961515, 2.1302651705641797, 3.2818606629781093, 4.648235095453058, 4.345624826872002, 5.311056201049992, 5.753972583478267, 4.966966878966292, 5.687377769469735, 3.378594641228816, 3.724746520942307, 2.5068869273448637, 2.089416643652524, 2.2244325828483476, -1.5274374320264439, -1.5562495323100167, -0.6125119612628858, -2.423479614297431, -3.6936008895358454, -4.388813740752571, -2.854611911820127, -4.826404632800256, -4.572934893501845, -5.256601167670888, -4.099462848728823, -4.33604478745585, -4.816704386332135, -3.4583268405428713, -2.8384466420435683, -1.5125591619739749, -1.7625812266917775, 1.0157214852397545, 1.5095445502150102, 1.870631826947684, 2.0939755781446716, 1.5856545844653414, 2.58196547285172, 3.39753579431135, 5.264149506436597, 5.5893111966405895, 5.532014566927438, 4.3734134489260255, 6.189493491686161, 3.900783751807012, 3.5865611492307488, 0.6888304097686788, 0.10865269854412674, 0.9240575679009976, -0.7873680813469807, -2.7703355600198663, -1.9661351740983313, -3.508800442837363, -1.8306811210565046, -6.640595521684698, -4.777744190652245, -2.7724811787230283, -4.5073250427912415, -6.150295867603678, -3.5490954433689246, -4.787850673669156, -3.591325707404745, -1.0202459490603868, -2.330610271053504, -0.4834974609738696];

  // let float_vector1: RawData = RawData::FloatVec(signal);

  // let mut filter = Peak_Finder::new();

  // let output = filter.run_peakfinder_min_hdp(&float_vector1,2.0,4.0,1.0);

  // let mut my_empty_vec: Vec<usize> = Vec::new();

  // for element in output{
  //   let number = element.middle_position();
  //   my_empty_vec.push(number);
  // }

  // my_empty_vec.sort();

  // print!("{:?}", my_empty_vec);






  //  let signal1: RawData= RawData::FloatVec(vec![0.91836795, -0.7550365, -0.82229968, 0.38470112, 0.32756556, -0.1500332,
  //  -0.47942242, 0.78735185, -0.3130074, -0.78962053, 0.68406937, -0.10941988,
  //  0.85765562, -0.33443927, -0.88293069, -0.45943362, 0.7827355, -0.98156005,
  //  0.1983309, 1.0490953, 0.78269412, 0.48753985, -0.4683345, -0.08328862,
  //  0.47133147, 0.85514289, 0.02800922, 0.07371882, -0.28892876, 0.89355418,
  //  0.20687296, -0.98254069, 0.73257495, 0.97115261, 0.88601853, 0.49660099,
  //  -0.60699654, 0.99018712, 0.74853154, 1.03390956, 0.56113442, 0.93391565,
  //  -0.34803287, -0.49468972, 0.54351342, 0.54288017, 0.56071839, -0.6816979,
  //  0.44131403, 0.71416583, -0.20408451, -0.52847594, -0.86575061, 0.3189754,
  //  0.03358667, -0.62728735, -0.19742717, -0.08853031, 0.82239147, 0.38570716,
  //  -0.24534994, -0.55948792, 0.25647286, -0.60632081, 1.00364816, -0.40964857,
  //  0.84938726, -0.54761025, 0.86841654, -0.9697848, 0.81779373, -0.74209949,
  //  -0.01043969, 0.0437089, 0.91153038, 0.37510173, 0.6870717, -0.51927701,
  //  0.22990968, -0.11206606, -0.70855284, -0.68672557, 0.34639136, 0.07711553,
  //  0.74687533, -0.86588636, 0.60308048, 0.44784163, -0.48820096, -0.26549696,
  //  0.6144216, 0.44270719, 0.28133413, -0.79150201, 0.05373624, -0.59698319,
  //  -0.44591376, 0.16755127, 0.27518268, 0.40648236]);



  //   let signal2: RawData= RawData::FloatVec(vec![-1.9683332331608474, -1.717858749355179, -3.759961365429422, -4.958623529379432, -5.485220603297286, -5.068780129646672, -4.96318014526072, -4.885967921675111, -5.829251675123736, -5.47186926387927, -4.047547235539912, -2.603374446559637, -3.946247752610877, -2.524435539984913, -1.797839878650658, -1.1220409621672651, 1.6720838919353374, 1.6955798780859315, 2.343381110638523, 3.218182666426548, 4.358122202583721, 4.765740984503017, 5.3746528409941625, 5.473490191594698, 5.4459250607079674, 4.222194023309575, 3.5631737543611535, 3.209953535535739, 2.2679968750567174, 1.689690757910821, -0.597044682792282, 1.2295096458344235, -0.5099352431494522, 0.47697194842395163, -2.3072239466746938, -3.042292567304973, -3.0447360037997395, -4.4776430466367305, -3.754204593262017, -6.087502919033549, -6.871119514379643, -4.411786302246042, -4.250411245136818, -4.024648954752383, -2.0401752910605495, -1.612949159415131, -2.3769865860842545, -3.15653998158343, -1.7163347916741254, 0.041943799144170235, 1.9018582516181133, 3.2137686101959435, 5.1216168049167985, 5.181272248816972, 4.177162647343236, 4.910559911650967, 5.430561901903032, 4.914839631100418, 4.082933712117779, 4.125764189831912, 3.7388394862747076, 3.7039793267104413, 3.4453653760211003, 1.1568404633907297, 1.1097420809409058, -0.8366844407434536, 0.00032929428028360963, -3.0127224874629523, -3.196935686912258, -4.808196244200207, -2.427739953054134, -5.288749141528557, -5.618464881445853, -3.662019379370501, -3.6482452220249724, -5.135757449930187, -4.660772381705265, -3.181033464835836, -2.183318478654945, -2.3096138598753755, -1.2072178300697296, 0.004073366967373482, 0.7634358906696369, 1.628489695396944, 1.9386947863288453, 2.8495583435889706, 5.59416091360117, 5.735551370915663, 3.5437303978327774, 4.885360913010343, 5.694246040053638, 5.902074521402208, 2.9898795350334995, 4.082546886152893, 4.420324680868482, 2.121238103640503, 1.5554249240012745, 1.0624173628602152, -0.3805941604330543, 0.00011955967508203713, -0.2726198877084691, -3.621165345065073, -2.3106682155706144, -3.008464055318883, -3.6791882243878735, -4.681285864712197, -3.6334225993506166, -4.216214656199944, -3.4899568532177225, -3.548036363731245, -2.886494585475302, -4.936660352815803, -2.590725789953134, -0.9882265278389202, -1.9279100219395602, -1.6026134543636394, 0.02413537999056925, 2.228901718042568, 1.322235456219919, 2.8494026435100954, 3.296661931119425, 6.027538285328892, 4.415979085282228, 5.1100437331543205, 6.295100814736361, 4.157654148903779, 3.8250625551763227, 3.210057612689865, 3.7263865243097665, 2.8724625295607904, 2.548551211873285, -0.7489415406426848, -0.22617745492874, -2.4690964140781864, -3.1401384827052907, -2.95160194936303, -3.968833387736624, -3.2246928010573304, -4.339702569114829, -4.609928246384497, -5.523486704135764, -4.33018351888759, -4.513375833855275, -5.613725875069774, -2.368110485069924, -4.174489468416508, -1.5462599231221796, -1.9112933863303545, -0.7448649061967919, -0.8100404653366764, 1.578768228660318, 3.0605698950709415, 4.481529255021599, 3.4321456403958956, 4.286162492840878, 3.542600865086815, 3.9863354311677752, 4.757085954129289, 4.696489704364847, 4.918603410598548, 3.5493191430519846, 3.666916622021471, 2.649908498384805, -0.7993657203092499, 1.7223957104697152, -1.5785502884870446, -1.5507321245573968, -2.3615494902364422, -1.9385720891906806, -3.30170673067445, -5.686723548491335, -5.69901727429125, -5.582951744522848, -6.659112241922954, -3.835897601355358, -5.404322318188626, -5.3489078376148065, -3.838447935719378, -3.6260649126217097, -3.2306088202096084, -1.0770129610851251, -0.25261828030183275, -1.2157559997094975, 1.9728883910883366, 2.069412523961515, 2.1302651705641797, 3.2818606629781093, 4.648235095453058, 4.345624826872002, 5.311056201049992, 5.753972583478267, 4.966966878966292, 5.687377769469735, 3.378594641228816, 3.724746520942307, 2.5068869273448637, 2.089416643652524, 2.2244325828483476, -1.5274374320264439, -1.5562495323100167, -0.6125119612628858, -2.423479614297431, -3.6936008895358454, -4.388813740752571, -2.854611911820127, -4.826404632800256, -4.572934893501845, -5.256601167670888, -4.099462848728823, -4.33604478745585, -4.816704386332135, -3.4583268405428713, -2.8384466420435683, -1.5125591619739749, -1.7625812266917775, 1.0157214852397545, 1.5095445502150102, 1.870631826947684, 2.0939755781446716, 1.5856545844653414, 2.58196547285172, 3.39753579431135, 5.264149506436597, 5.5893111966405895, 5.532014566927438, 4.3734134489260255, 6.189493491686161, 3.900783751807012, 3.5865611492307488, 0.6888304097686788, 0.10865269854412674, 0.9240575679009976, -0.7873680813469807, -2.7703355600198663, -1.9661351740983313, -3.508800442837363, -1.8306811210565046, -6.640595521684698, -4.777744190652245, -2.7724811787230283, -4.5073250427912415, -6.150295867603678, -3.5490954433689246, -4.787850673669156, -3.591325707404745, -1.0202459490603868, -2.330610271053504, -0.4834974609738696]);        
  //   let signal3: RawData= RawData::FloatVec(vec![57.42375095409937, 56.93672522014874, 62.608713592930876, 58.58999011614217, 53.781514473465975, 59.929765521680004, 62.83874316763905, 61.26564682933764, 60.298077069774514, 65.69037167656037, 64.4924856859658, 57.45776902834044, 67.2979270744406, 64.3065399558438, 69.10913177362237, 69.68135328937724, 66.27441648596799, 66.5712753857469, 68.7197206786976, 66.77069404089671, 69.47343229079385, 73.49687241835524, 74.39038713833476, 69.77134706156811, 71.11611036527033, 71.5514143700266, 70.92527568110486, 75.81690366006418, 71.48430850738842, 73.99189451125514, 77.46501916351879, 75.58651101737665, 78.48004995555802, 75.23963596784876, 80.30163806050568, 77.62973765421143, 80.16175629224077, 80.68837591441441, 79.6905673290241, 83.3649494980984, 83.41729893388869, 81.27997708388136, 82.92243382684352, 83.78103585804621, 83.22618159997842, 84.46526224102954, 84.07977328452601, 81.7653661597366, 83.24232423541409, 82.98821921592604, 84.52930477159329, 86.00457616832857, 84.85465642598282, 79.6146939926643, 83.91264690823981, 84.58107619775576, 86.86586732593057, 86.87782780765482, 86.49708394674948, 84.66183307481079, 83.32273574233504, 89.75815463910952, 81.73921292290746, 83.57667052875678, 82.29154311686115, 81.15090505024507, 81.0181809858243, 80.02406477550639, 79.95626138939767, 80.14968471195097, 77.93833929477205, 83.37140263453084, 80.63006474812504, 80.54886758093564, 74.61328386499513, 76.2067956336496, 75.93496294510105, 74.80986359211977, 79.09967283013746, 73.35452123905561, 76.43997860290371, 73.37084091593962, 72.27187673807346, 76.47512075935063, 73.51588873047531, 74.04609287428879, 73.5220350777692, 71.2657426722753, 69.51314201809633, 70.77160782734013, 68.74978122247276, 71.97834832913482, 68.52537097152933, 68.24617406288941, 69.73725303822009, 70.11807598587777, 69.35509863639831, 69.47650042355208, 66.64598319409271, 68.3345766746571, 66.2569569225079, 66.38695004387625, 58.302036498704005, 59.823489245315685, 63.90206250674178, 67.44946967703007, 64.55800828600442, 64.17137953752636, 64.24996006660133, 64.60722809289496, 62.715507684022455, 62.10266642672423, 62.987139113750466, 62.56118234068753, 60.74277369885567, 61.304485787724424, 63.39768612316597, 59.17504593185429, 60.92293919145394, 61.74329340412283, 57.66140451493842, 62.09807476069308, 61.33026367110421, 59.73879796926617, 58.5720628991695, 59.94647404967808, 62.000588448844795, 60.33024266169896, 60.98985504062868, 58.65602786741151, 59.89716687482642, 57.61316051537118, 57.166505274132426, 58.96556719641834, 60.37679949619507, 54.45584180986487, 58.7271982420652, 59.47366447708427, 56.07940328686498, 55.78066887807596, 54.54564631742577, 54.52126114421135, 56.12296587524522, 55.80474208024708, 55.450268698368774, 53.6860047610941, 56.265818477761954, 51.87808742443517, 54.7399559253531, 56.05143364518187, 52.41066187331751, 49.34598557487828, 50.79534970301276, 50.994619031875516, 54.5066732568543, 45.641877225921085, 45.44783149223058, 49.71813811826957, 49.06417606679746, 48.47113041190944, 45.066752680131536, 45.691797364781955, 46.04972969161036, 46.937126956810964, 48.579890629805696, 46.87831648338302, 43.2621571874902, 42.41539084532762, 47.732792000519055, 42.635078585330035, 45.25466510897015, 44.20457419707335, 39.80087116943825, 43.16784163357121, 42.72139421919673, 40.09690411968018, 39.072075680860785, 39.68721522523129, 39.69694747954145, 38.89958622251241, 36.20930810783846, 38.54348444090701, 39.49315655173681, 37.22306536922959, 38.45119902245094, 38.36169803033943, 36.27817076033729, 38.495487020334416, 36.08203266391632, 35.61234698124961, 37.31850254780822, 35.73508343583559, 34.24509993239897, 38.21302621383962, 35.21073369085666, 34.7557606412574, 38.30832823832005, 37.01263245066287, 38.27243482312153, 35.10563354463935, 36.54702691361821, 37.496545142093524, 40.21495219978659, 33.4472745629568, 36.19003918456128, 40.40279302834972, 39.782856300732334, 38.65349615550868, 39.553456446758894, 43.1239603503975, 38.65895285386617, 41.549607795356614, 41.87845934752343, 41.252783475633485, 41.294266760442, 42.2846785280957, 45.66429780888518, 48.37613972205177, 45.184550578912244, 45.83903707029868, 50.45023663869127, 47.807444589854164, 49.6770059662178, 47.06600589312027, 50.35579734602591, 45.08336916260292, 48.369671422972786, 50.56098595974319, 50.60044633370852, 54.91737419172761, 55.587993290196444, 51.32300551457022, 54.80025666186663, 51.74767705510797, 54.84209797727291, 56.02482448641735, 55.61823652859607, 58.55601631729386, 60.72812364016489, 58.75761743767916, 59.151794377943254, 59.22341098206529, 63.837931340247394, 61.3622177601643, 62.552959520063325, 62.90488582386602, 64.7298637786503, 64.29580055208083, 67.19411603468367]);      

  //   let mut filter: Fft = Fft::new();
  
  //   let real_part: Vec<f32> = filter.run_inverse_real(&signal3);
  //   let imag_part: Vec<f32> = filter.run_inverse_imag(&signal3);

  //        // Print the real and imaginary parts
  //    println!("Real Part: {:?}", real_part);
  //    println!("Imaginary Part: {:?}", imag_part);



    // let before = Instant::now();
    // let mut filter: bandpass::butterworth::biquad_butterworth = bandpass::butterworth::biquad_butterworth::new(cutoff_freq, sample_rate);

    // let result: Vec<f32> = filter.filtfilt(float1);
    // println!("Elapsed time: {:.2?}", before.elapsed());


   // print!("{:?}",result);



  // let mut time_storage: Vec<f32> = Vec::new();

  //   for _ in 0..50 {


  //     let before = Instant::now();

  //     let mut filter = moving_average_filter::moving_average_filter::new();

  //     let output = filter.process(&int_vector1);

  //     time_storage.push(before.elapsed().as_secs_f32())

  // }

  //    let average: f32 = time_storage.iter().sum::<f32>() / time_storage.len() as f32;
  //    println!("Elapsed time: {}", average);

 
    //  // Print the real and imaginary parts
    //  println!("Real Part: {:?}", real_part);
    //  println!("Imaginary Part: {:?}", imag_part);

    // let vector = RawData::FloatVec(vec![1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0]);

    // let data: DataResampling = DataResampling::new();

    // let return_vector = data.resampling_by_average(&vector,33.0,100.0);

    // print!{"{:?}", return_vector};



}


        

    


    


